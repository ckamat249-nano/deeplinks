<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Button Alert App</title>
  <style>
    body, html {
      height: 100vh;
      margin: 0;
      display: flex;
      align-items: center;
      justify-content: center;
      background: #f5f5f5;
      font-family: sans-serif;
    }
    .container {
      display: flex;
      flex-direction: column; /* change to column for up/down navigation */
      gap: 2rem;
      align-items: center;
    }
    button {
      padding: 1rem 2rem;
      font-size: 1.2rem;
      cursor: pointer;
      border-radius: 8px;
      border: 2px solid #666;
      background: #fff;
      transition: background 0.2s, border 0.2s;
    }
    button:focus {
      outline: none;
      border-color: #1976d2;
      background: #e3f0ff;
    }
    button:hover {
      background: #f0f0f0;
    }
        /* Optional CSS to center the game wrapper */
        #game-container {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 50vh; /* Full height of the viewport */
        }
  </style>
  </head>
<body>
  <!-- align the buttons to left and push game container to right -->
  <div class="container" style="align-items: flex-start; width: 300px; margin-right: auto;">
    <button id="btn1" tabindex="0" onclick="firebolt_discovery('xre:///guide/x2/settings/audio/bluetooth.xml')">BT Settings Firebolt</button>
    <button id="btn2" tabindex="1" onclick="$badger.deeplink('xre:///guide/x2/settings/audio/bluetooth.xml')">BT Settings Badger</button>
  </div>
  <script>
    
    // Set focus to the first button on page load
    window.onload = function() {
      document.getElementById('btn1').focus();
    }

    // get gamepad input for accessibility navigation

    window.addEventListener("gamepadconnected", function(e) {
      console.log("Gamepad connected:", e.gamepad);
    });

    window.addEventListener("gamepaddisconnected", function(e) {
      console.log("Gamepad disconnected:", e.gamepad);
    });

    let gamepadSet= new Set();
    function pollGamepad() {
      const gamepads = navigator.getGamepads ? navigator.getGamepads() : [];
      for (let gp of gamepads) {
        if (gp) {
          // Assuming button 0 is "A" and button 1 is "B"
          if (gp.buttons[0].pressed) {
            if (!gamepadSet.has(gp.id))
              document.activeElement.click();
            gamepadSet.add(gp.id);
          } else if (gp.buttons[12].pressed) {
            if (!gamepadSet.has(gp.id))
              moveFocus(-1);
            gamepadSet.add(gp.id);
          } else if (gp.buttons[13].pressed) {
            if (!gamepadSet.has(gp.id))
              moveFocus(1);
            gamepadSet.add(gp.id);
          } else {
            gamepadSet.delete(gp.id);
          }
        }
      }
      requestAnimationFrame(pollGamepad);
    }
    
    function moveFocus(direction) {
      const buttons = Array.from(document.querySelectorAll('button'));
      const currentIndex = buttons.indexOf(document.activeElement);
      let nextIndex = (currentIndex + direction + buttons.length) % buttons.length;
      buttons[nextIndex].focus();
    }

    // pollGamepad();

    const buttons = Array.from(document.querySelectorAll('button'));
    buttons.forEach((btn, idx) => {
      btn.addEventListener('keydown', function(e) {
        if (e.key === 'Enter' || e.key === ' ') {
          e.preventDefault();
          btn.click();
        } else if (e.key === 'ArrowDown') {
          e.preventDefault();
          const next = buttons[(idx + 1) % buttons.length];
          next.focus();
        } else if (e.key === 'ArrowUp') {
          e.preventDefault();
          const prev = buttons[(idx - 1 + buttons.length) % buttons.length];
          prev.focus();
        }
      });
    });
  </script>
  <script src="https://cdn.thor.comcast.com/sdk/money-badger.min.js"></script>
  <script src="./dist/bundle.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/phaser@3.55.2/dist/phaser.min.js"></script>
  <script>
    // Phaser 3 basic setup
    class MyScene extends Phaser.Scene {
      constructor() {
        super({ key: 'MyScene' });
      }

      preload() {
        console.log('Preloading assets...');
        // Load assets here
        this.load.image('ball', 'https://mdn.github.io/shared-assets/images/examples/2D_breakout_game_Phaser/ball.png');
        this.load.image('paddle', 'https://mdn.github.io/shared-assets/images/examples/2D_breakout_game_Phaser/paddle.png');
      }

      create() {
        // Create game objects here
       this.ball = this.add.sprite(
          this.scale.width * 0.5,
          0,
          "ball",
        );
        this.paddle = this.add.sprite(this.scale.width * 0.5,
            this.scale.height - 5,
            "paddle",
          );
        this.paddle.setOrigin(0.5, 1);
        this.physics.add.existing(this.ball);
        this.physics.add.existing(this.paddle);
        this.ball.body.setCollideWorldBounds(true,1, 1);
        this.ball.body.setBounce(1, 1);
        this.ball.body.setVelocity(150, -150);
        this.ball.body.gravity.y = 500;
        this.paddle.body.setImmovable(true);
        this.ball.body.setBounce(1);
      }

      update() {
        // Game loop logic here
        this.paddle.x = this.input.x;
        this.physics.collide(this.ball, this.paddle);
        this.paddle.x = this.input.x || this.scale.width * 0.5;
      }
    }

     const config = {
      type: Phaser.AUTO,
      physics: {
        default: 'arcade',
      },
      backgroundColor: '#eeeeee',
      scene: MyScene
    };

    const game = new Phaser.Game(config);
    // place the game canvas inside the container div
  </script>
</body>
</html>